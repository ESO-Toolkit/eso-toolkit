{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Merge Queue Configuration",
  "description": "Configuration for the ESO Log Aggregator merge queue system",
  "type": "object",
  "properties": {
    "labels": {
      "type": "object",
      "properties": {
        "mergeQueue": {
          "type": "string",
          "default": "auto-merge",
          "description": "Label to add PRs to the merge queue (changed from 'merge-queue' to 'auto-merge')"
        },
        "autoMerge": {
          "type": "string", 
          "default": "auto-merge",
          "description": "Label for auto-merge (same as mergeQueue)"
        },
        "priority": {
          "type": "array",
          "items": { "type": "string" },
          "default": ["priority", "hotfix", "critical"],
          "description": "Labels that give PRs priority in the queue"
        },
        "blocking": {
          "type": "array",
          "items": { "type": "string" },
          "default": ["do not merge", "do-not-merge", "wip", "work in progress", "needs review"],
          "description": "Labels that prevent PRs from being merged"
        }
      }
    },
    "requirements": {
      "type": "object",
      "properties": {
        "reviews": {
          "type": "integer",
          "default": 1,
          "minimum": 0,
          "description": "Number of required approving reviews"
        },
        "checks": {
          "type": "array",
          "items": { "type": "string" },
          "default": [
            "build",
            "lint", 
            "format",
            "test",
            "typecheck",
            "build-storybook",
            "playwright-smoke",
            "check-do-not-merge-label"
          ],
          "description": "Required status checks that must pass"
        }
      }
    },
    "mergeMethod": {
      "type": "string",
      "enum": ["merge", "squash", "rebase"],
      "default": "squash",
      "description": "Method used to merge PRs"
    },
    "targetBranch": {
      "type": "string",
      "default": "main",
      "description": "Target branch for merging PRs"
    },
    "processingInterval": {
      "type": "integer",
      "default": 300,
      "minimum": 60,
      "description": "Interval in seconds between automatic queue processing (when using scheduled processing)"
    },
    "notifications": {
      "type": "object",
      "properties": {
        "onMerge": {
          "type": "boolean",
          "default": true,
          "description": "Post comment when PR is merged"
        },
        "onBlock": {
          "type": "boolean", 
          "default": true,
          "description": "Post comment when PR is blocked"
        },
        "statusUpdates": {
          "type": "boolean",
          "default": true,
          "description": "Post status update comments"
        }
      }
    },
    "safetyChecks": {
      "type": "object",
      "properties": {
        "requireUpToDate": {
          "type": "boolean",
          "default": true,
          "description": "Require PR branch to be up-to-date with target branch"
        },
        "requireLinearHistory": {
          "type": "boolean",
          "default": false,
          "description": "Require linear commit history"
        },
        "maxQueueSize": {
          "type": "integer",
          "default": 50,
          "minimum": 1,
          "description": "Maximum number of PRs allowed in queue"
        }
      }
    }
  },
  "required": ["labels", "requirements", "mergeMethod", "targetBranch"]
}